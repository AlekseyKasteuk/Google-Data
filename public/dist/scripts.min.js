var app=angular.module("GoogleData",["ui.router","ui.tinymce","ngMaterial","ngMessages","ngFileUpload","ngImgCrop"]);app.config(["$httpProvider","$urlRouterProvider","$stateProvider","$locationProvider","$mdIconProvider","$mdThemingProvider",function(t,e,o,r,a,l){e.otherwise("/"),o.state("login",{url:"/login",templateUrl:"application/states/login/login.html",controller:"LoginCtrl"}).state("app",{url:"/",templateUrl:"application/states/app/app.html",controller:"AppCtrl"}).state("app.profile",{url:"profile",templateUrl:"application/states/app/profile/profile.html",controller:"ProfileCtrl"}),l.theme("default").primaryPalette("blue").accentPalette("indigo")}]),app.run(["$rootScope","$state","$stateParams","authService",function(t,e,o,r){t.$on("$stateChangeStart",function(o,a,l){r.checkAuth().success(function(o){t.authorizedUser=o,console.log(o),"login"==a.name&&e.go("app")}).error(function(){t.authorizedUser=void 0,"login"!=a.name&&e.go("login")})})}]);
app.directive("profileCard",["profileService","$timeout",function(e,i){return{restrict:"A",scope:{},templateUrl:"/application/directives/profile_card/profile_card.html",link:function(r,o){function n(){e.getFullInformation().success(function(e){console.log(e),r.user=e}).error(function(){})}r.profile={type:"Internal"},o.bind("animationend",function(){o.removeClass("rotated-profile-card")}),r.changeProfileType=function(e){o.addClass("rotated-profile-card"),i(function(){r.profile.type=e},500)},n()}}}]);
app.directive("spinner",function(){return{restrict:"E",scope:{},template:"<div><md-progress-circular md-mode='indeterminate'></md-progress-circular></div>"}});
app.controller("createNewAccountCtrl",["$scope","$mdDialog","authService",function(e,c,n){e.user={},e.hide=function(){c.hide()},e.cancel=function(){c.cancel()},e.answer=function(){n.createNewAccount(e.user).success(function(){c.hide(e.user.first_name+" "+e.user.last_name)}).error(function(){})}}]);
app.controller("ProfileDlgCtrl",["$scope","$mdDialog","uploadFileService","$timeout",function(n,e,i,o){n.close=function(){e.cancel()},n.upload=function(l,c){n.enableSpinner=!0,i(l,"/profile/avatar",c).then(function(){o(function(){n.enableSpinner=!1,e.hide()},1e3)},function(){n.enableSpinner=!1})}}]);
app.factory("authService",["$http",function(t){return{login:function(n){return t.post("/login",n)},logout:function(){return t.post("/logout")},checkAuth:function(){return t.get("/auth/check")},createNewAccount:function(n){return t.post("/create/account",n)}}}]);
app.factory("profileService",["$http",function(t){return{getFullInformation:function(){return t.get("/user/info")}}}]);
app.factory("socket",["$rootScope",function(n){var o=io.connect();return{on:function(t,c){o.on(t,function(){var t=arguments;n.$apply(function(){c.apply(o,t)})})},emit:function(t,c,p){o.emit(t,c,function(){var t=arguments;n.$apply(function(){p&&p.apply(o,t)})})}}}]);
app.factory("uploadFileService",["Upload",function(o){return function(t,a,l){return console.log(o.dataUrltoBlob(t,l).toString()),o.upload({url:a,method:"POST",data:{message:"HELLO WORLD!"},file:o.dataUrltoBlob(t,l)})}}]);
app.controller("LoginCtrl",["$scope","authService","$mdDialog","$state","$mdToast",function(t,e,o,n,c){t.user={},t.login=function(){e.login(t.user).success(function(){n.go("app")}).error(function(t){c.show(c.simple().textContent(t).action("OK").highlightAction(!1).position("top left"))})},t.showAlert=function(t){o.show({controller:"createNewAccountCtrl",templateUrl:"application/modal_dialogs/create_new_account/create_new_account.html",parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0,fullscreen:!0}).then(function(t){c.show(c.simple().textContent(t+" was created").action("OK").highlightAction(!1).position("top left"))})}}]);
app.directive("profileCardGoogle",["$mdDialog",function(e){return{restrict:"A",scope:!1,templateUrl:"/application/directives/profile_card/google/google.html",link:function(o,t){o.addNewGoogleAccount=function(){$window.location.href="/google"},o.selectAvatar=function(){e.show({controller:"ProfileDlgCtrl",templateUrl:"application/modal_dialogs/profile/profile_dlg.html",parent:angular.element(document.body),targetEvent:event,clickOutsideToClose:!1,fullscreen:!0,openFrom:angular.element(document.querySelector("#current-user-avatar")),closeTo:angular.element(document.querySelector("#current-user-avatar"))}).then(function(){getInfo()})}}}}]);
app.controller("AppCtrl",["$scope","socket","$state","authService","$mdDialog",function(t,i,n,e,l){t.logout=function(){e.logout().success(function(){n.go("login")})},i.on("authorization_faild",function(){n.go("login")}),t.tinymceOptions={onChange:function(t){console.log(t)},inline:!1,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks fullscreen media","insertdatetime table contextmenu paste"],toolbar:"insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image",skin:"lightgray",theme:"modern",statusbar:!1,width:450,height:455}}]);
app.directive("profileCardInternal",["$mdDialog",function(e){return{restrict:"A",scope:!1,templateUrl:"/application/directives/profile_card/internal/internal.html",link:function(t,r){t.selectAvatar=function(){e.show({controller:"ProfileDlgCtrl",templateUrl:"application/modal_dialogs/profile/profile_dlg.html",parent:angular.element(document.body),targetEvent:event,clickOutsideToClose:!1,fullscreen:!0,openFrom:angular.element(document.querySelector("#current-user-avatar")),closeTo:angular.element(document.querySelector("#current-user-avatar"))}).then(function(){getInfo()})}}}}]);
app.controller("EmailCtrl",function(){});
app.controller("ProfileCtrl",["$scope","profileService","$mdDialog","$window","uploadFileService",function(e,o,i,l,r){}]);